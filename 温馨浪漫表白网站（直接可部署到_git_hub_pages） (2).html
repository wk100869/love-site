<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç»™ä½ çš„å°å°å‘Šç™½</title>
  <meta name="description" content="ä¸€ä¸ªæ¸©é¦¨æµªæ¼«çš„è¡¨ç™½å°ç«™" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ’–</text></svg>">
  <style>
    :root {
      --pink: #ff7aa2;
      --rose: #ff5c8a;
      --dark: #1a131b;
      --light: #fff7fb;
      --gold: #ffd166;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      color: #2b2230;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Hiragino Sans GB", "PingFang SC", "Noto Sans CJK SC", "Microsoft Yahei", sans-serif;
      background: radial-gradient(1200px 800px at 70% -10%, rgba(255, 170, 196, 0.4), transparent),
                  radial-gradient(1000px 700px at -10% 40%, rgba(255, 214, 230, 0.5), transparent),
                  linear-gradient(180deg, #fff5fa, #ffeaf3 60%, #ffe1ee);
      overflow-x: hidden;
    }
    /* Floating hearts */
    .hearts {
      position: fixed; inset: 0; pointer-events: none; z-index: 0;
      overflow: hidden;
    }
    .heart {
      position: absolute; width: 14px; height: 14px; transform: rotate(45deg);
      background: var(--rose); opacity: .18; border-radius: 2px;
      animation: float 12s linear infinite;
    }
    .heart::before, .heart::after{
      content: ""; position: absolute; width: 100%; height: 100%; background: inherit; border-radius: 50%;
    }
    .heart::before{ left:-50%; }
    .heart::after{ top:-50%; }
    @keyframes float {
      0% { transform: translateY(110vh) rotate(45deg) scale(.8); }
      100% { transform: translateY(-20vh) rotate(45deg) scale(1.1); }
    }

    /* Layout */
    .wrap { position: relative; z-index: 1; }
    header.hero{
      min-height: 86vh; display:flex; align-items:center; justify-content:center; text-align:center; padding: 64px 20px 24px;
    }
    .card {
      background: rgba(255,255,255,.75);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 162, 191, .4);
      border-radius: 24px; padding: 28px; box-shadow: 0 20px 50px rgba(255, 92, 138, .18);
    }
    h1 { font-weight: 800; letter-spacing: .5px; line-height: 1.2; margin: 0 0 8px; font-size: clamp(26px, 5vw, 48px); }
    .subtitle { font-size: clamp(14px, 2.4vw, 18px); color:#7a5b67; }
    .btns { display:flex; flex-wrap:wrap; gap:12px; justify-content:center; margin-top: 20px; }
    .btn {
      appearance:none; border:none; cursor:pointer; border-radius: 999px; padding: 12px 18px; font-weight: 700;
      background: linear-gradient(135deg, var(--rose), var(--pink)); color: white; box-shadow: 0 10px 20px rgba(255, 92, 138, .35);
      transition: transform .15s ease, box-shadow .15s ease, filter .15s ease;
    }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 12px 24px rgba(255, 92, 138, .45); }
    .btn.ghost { background: white; color: #ff4d86; border: 2px solid #ffc4d7; }

    /* Sections */
    section { padding: 40px 18px; }
    .container { max-width: 1000px; margin: 0 auto; }

    .grid { display:grid; gap: 16px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
    .photo { position: relative; overflow:hidden; border-radius: 16px; aspect-ratio: 4/3; background:#fff; border: 1px solid #ffe1ec; }
    .photo img { width:100%; height:100%; object-fit: cover; transition: transform .6s ease; }
    .photo:hover img { transform: scale(1.06); }

    .timeline { position:relative; padding-left: 22px; }
    .timeline::before{ content:""; position:absolute; left:8px; top:0; bottom:0; width: 2px; background: linear-gradient(var(--rose), transparent); }
    .tl-item { margin: 14px 0; padding: 12px 14px 12px 14px; background: #fff; border-radius: 14px; border: 1px solid #ffd1e2; box-shadow: 0 8px 24px rgba(255,92,138,.12); }
    .tl-item b { color:#ff2f78 }

    .counter { display:flex; gap: 10px; flex-wrap:wrap; justify-content:center; font-variant-numeric: tabular-nums; }
    .num { background:#fff; padding: 12px 14px; border-radius: 12px; border:1px solid #ffe1ec; min-width:84px; text-align:center; }
    .num big { display:block; font-size: 28px; font-weight: 800; color:#ff2f78; }

    footer { text-align:center; padding: 28px 16px 60px; color:#8a6b76; }

    /* Modal */
    dialog { border:none; border-radius: 20px; padding: 0; width: min(680px, 92vw); box-shadow: 0 30px 80px rgba(0,0,0,.2); }
    dialog::backdrop { background: rgba(0,0,0,.25); backdrop-filter: blur(2px); }
    .modal-head { padding: 20px 22px 0; }
    .modal-body { padding: 4px 22px 22px; }

    /* Floating play badge */
    .music-floating { position: fixed; right: 14px; bottom: 14px; z-index: 3; display:flex; align-items:center; gap:10px; }
    .disk { width: 46px; height: 46px; border-radius: 50%; background: conic-gradient(from 0deg, #ff9abb, #fff, #ff9abb); display:grid; place-items:center; box-shadow:0 8px 20px rgba(255, 92, 138, .28); animation: spin 6s linear infinite paused; }
    .disk::after { content:""; width: 14px; height: 14px; background:#111; border-radius: 50%; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .badge { background: #fff; border: 2px solid #ffc8db; padding: 8px 12px; border-radius: 999px; font-weight: 700; color:#ff2f78; }
    .hide { display:none !important; }

    /* Canvas fireworks */
    #fw { position: fixed; inset: 0; pointer-events: none; z-index: 2; }

    /* Small */
    @media (min-width: 768px){ .card { padding: 36px 44px; } }
  </style>
</head>
<body>
  <canvas id="fw"></canvas>
  <div class="hearts" id="hearts"></div>

  <div class="wrap">
    <header class="hero">
      <div class="card">
        <div class="subtitle">å†™ç»™ <span id="toName">äº²çˆ±çš„ä½ </span> çš„ç¬¬ <span id="dayCount">0</span> å¤©</div>
        <h1 id="headline">æˆ‘æƒ³æŠŠå…¨ä¸–ç•Œæœ€æ¸©æŸ”çš„é£<br/>éƒ½å¹å‘ä½ </h1>
        <p class="subtitle">ä» <span id="startDateText">2024-02-14</span> åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬ä¸€èµ·ç»å†äº†æ— æ•°å°ç¡®å¹¸ã€‚<br>ä»Šå¤©ï¼Œæƒ³æŠŠè¿™äº›å–œæ¬¢éƒ½è®¤çœŸè¯´ç»™ä½ å¬ã€‚</p>
        <div class="btns">
          <button class="btn" id="btnPlay">â–¶ï¸ æ’­æ”¾éŸ³ä¹</button>
          <button class="btn ghost" id="btnLetter">ğŸ’Œ ç»™ä½ çš„ä¸€å°ä¿¡</button>
          <button class="btn ghost" id="btnStory">ğŸ“– æˆ‘ä»¬çš„æ•…äº‹</button>
          <button class="btn" id="btnAsk">ğŸ’ æˆ‘æ„¿æ„ï¼</button>
        </div>
      </div>
    </header>

    <section>
      <div class="container">
        <h2 style="margin:0 0 10px">æˆ‘ä»¬çš„å›å¿†ç›¸å†Œ</h2>
        <p class="subtitle" style="margin:0 0 18px">æ›¿æ¢å›¾ç‰‡ä¸ºä½ ä»¬çš„åˆç…§å³å¯ï¼ˆ./images/1.jpg ...ï¼‰</p>
        <div class="grid">
          <figure class="photo"><img src="https://images.unsplash.com/photo-1522673607200-164d1b6ce486?q=80&w=1600&auto=format&fit=crop" alt="è®°å¿† 1"></figure>
          <figure class="photo"><img src="https://images.unsplash.com/photo-1520975928316-56c6c6bf88c9?q=80&w=1600&auto=format&fit=crop" alt="è®°å¿† 2"></figure>
          <figure class="photo"><img src="https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=1600&auto=format&fit=crop" alt="è®°å¿† 3"></figure>
          <figure class="photo"><img src="https://images.unsplash.com/photo-1513151233558-d860c5398176?q=80&w=1600&auto=format&fit=crop" alt="è®°å¿† 4"></figure>
        </div>
      </div>
    </section>

    <section>
      <div class="container">
        <h2 style="margin:0 0 10px">å°å°æ—¶é—´çº¿</h2>
        <div class="timeline" id="timeline">
          <div class="tl-item"><b>ç¬¬ä¸€æ¬¡ç›¸é‡</b> Â· åœ¨é‚£å®¶å’–å•¡åº—ï¼Œæˆ‘å‡è£…ä¸ç»æ„ï¼Œå…¶å®å¿ƒé‡Œå·²ç»å°é¹¿ä¹±æ’ã€‚</div>
          <div class="tl-item"><b>ç¬¬ä¸€å¼ åˆç…§</b> Â· ç»ˆäºæŠŠå–œæ¬¢æ‹äº†ä¸‹æ¥ï¼ŒåƒæŠŠæ˜¥å¤©æ”¶å…¥äº†é•œå¤´ã€‚</div>
          <div class="tl-item"><b>ç¬¬ä¸€æ¬¡ç‰µæ‰‹</b> Â· æŒ‡å°–ä¼ æ¥çš„æ˜¯å…¨ä¸–ç•Œçš„å®‰å®šã€‚</div>
          <div class="tl-item"><b>æˆ‘ä»¬çš„çºªå¿µæ—¥</b> Â· çº¦å®šåœ¨æ¯ä¸€å¹´çš„è¿™ä¸€å¤©ï¼Œéƒ½ç»™å½¼æ­¤ä¸€ä¸ªå°æƒŠå–œã€‚</div>
        </div>
      </div>
    </section>

    <section>
      <div class="container">
        <h2 style="margin:0 0 10px">ç”œèœœå€’æ•°</h2>
        <p class="subtitle" style="margin:0 0 16px">è·ç¦»ä¸‹ä¸€æ¬¡çºªå¿µæ—¥è¿˜æœ‰ï¼š</p>
        <div class="counter" id="counter">
          <div class="num"><small>Days</small><big id="cDay">00</big></div>
          <div class="num"><small>Hours</small><big id="cHour">00</big></div>
          <div class="num"><small>Minutes</small><big id="cMin">00</big></div>
          <div class="num"><small>Seconds</small><big id="cSec">00</big></div>
        </div>
      </div>
    </section>

    <footer>
      <div>Made with ğŸ’– for <span id="footerName">You</span> Â· <span id="year"></span></div>
    </footer>
  </div>

  <!-- Love Letter Modal -->
  <dialog id="letterModal">
    <div class="modal-head">
      <h3 style="margin:12px 0 6px">å†™ç»™ä½ çš„è¯</h3>
    </div>
    <div class="modal-body">
      <div class="subtitle">å¯ä»¥åœ¨æºç é‡Œè‡ªç”±ä¿®æ”¹è¿™æ®µæ–‡å­—~</div>
      <div class="card" style="margin-top:12px">
        <p id="letterText" style="margin:0; line-height:1.9">
          æˆ‘å–œæ¬¢ä½ ï¼Œå–œæ¬¢å’Œä½ èµ°åœ¨åŒä¸€æ¡è¡—ï¼Œå–œæ¬¢å’Œä½ çœ‹åŒä¸€åœºæ—¥è½ã€‚<br>
          æˆ‘ä»¬ä¸ç”¨å¾ˆå‰å®³çš„æƒ…è¯ï¼Œåªè¦è®¤è®¤çœŸçœŸçš„ä¸€èµ·ç”Ÿæ´»ã€‚<br>
          æœªæ¥å¾ˆé•¿ï¼Œæˆ‘éƒ½æƒ³å’Œä½ æ…¢æ…¢çœ‹ã€‚
        </p>
      </div>
      <div class="btns" style="justify-content:flex-end">
        <button class="btn ghost" id="closeLetter">å…³é—­</button>
      </div>
    </div>
  </dialog>

  <!-- Story Modal -->
  <dialog id="storyModal">
    <div class="modal-head">
      <h3 style="margin:12px 0 6px">æˆ‘ä»¬çš„æ•…äº‹</h3>
    </div>
    <div class="modal-body">
      <div class="card" style="margin-top:12px">
        <ol style="margin:0; padding-left: 18px; line-height: 1.9">
          <li>2024-02-14 Â· è®¤è¯†ä½ ï¼Œæ˜¯æˆ‘çš„å°å¹¸è¿ã€‚</li>
          <li>2024-05-20 Â· å½¼æ­¤è¯´å‡ºé‚£å¥å–œæ¬¢ã€‚</li>
          <li>2024-08-08 Â· ç¬¬ä¸€æ¬¡æ—…è¡Œï¼ŒåŸæ¥ä¸–ç•ŒçœŸçš„å¾ˆæ¸©æŸ”ã€‚</li>
          <li>2025-02-14 Â· æ–°çš„å¼€å§‹ï¼Œæ¯ä¸€å¤©éƒ½æ›´æƒ³ä½ ä¸€ç‚¹ç‚¹ã€‚</li>
        </ol>
      </div>
      <div class="btns" style="justify-content:flex-end">
        <button class="btn ghost" id="closeStory">å…³é—­</button>
      </div>
    </div>
  </dialog>

  <!-- Music floating control -->
  <div class="music-floating" id="musicCtl">
    <div class="disk" id="disk"></div>
    <button class="badge" id="badge">ç‚¹å‡»æ’­æ”¾</button>
  </div>

  <audio id="bgm" preload="auto" loop>
    <!-- é¦–é€‰ï¼šå…ç‰ˆæƒ BGMï¼ˆæ¥è‡ª Pixabay çš„ç›´é“¾ï¼‰ã€‚è‹¥æ— æ³•æ’­æ”¾ï¼Œè¯·æŠŠ music.mp3 æ”¾åœ¨åŒç›®å½•ã€‚ -->
    <source src="https://cdn.pixabay.com/download/audio/2021/11/23/audio_9f2d2d3b3e.mp3?filename=romantic-piano-ambient-110188.mp3" type="audio/mpeg">
    <source src="music.mp3" type="audio/mpeg">
  </audio>

  <script>
    // ====== åŸºæœ¬ä¸ªæ€§åŒ–ï¼ˆæŒ‰éœ€ä¿®æ”¹ï¼‰ ======
    const CONFIG = {
      toName: 'äº²çˆ±çš„ä½ ',       // æ˜¾ç¤ºåœ¨é¡¶éƒ¨ä¸é¡µè„š
      startDate: '2024-02-14',  // åœ¨ä¸€èµ·çš„æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰
      nextAnniv: '2026-02-14',  // ä¸‹ä¸€æ¬¡çºªå¿µæ—¥ï¼ˆYYYY-MM-DDï¼‰
      headline: 'æˆ‘æƒ³æŠŠå…¨ä¸–ç•Œæœ€æ¸©æŸ”çš„é£\néƒ½å¹å‘ä½ ',
    };

    // ====== DOM å¼•ç”¨ ======
    const $ = (s)=>document.querySelector(s);
    const hearts = $('#hearts');
    const bgm = $('#bgm');
    const disk = $('#disk');
    const badge = $('#badge');

    // æ–‡æ¡ˆä¸æ—¥æœŸåˆå§‹åŒ–
    $('#toName').textContent = CONFIG.toName;
    $('#footerName').textContent = CONFIG.toName;
    $('#startDateText').textContent = CONFIG.startDate;
    $('#headline').innerHTML = CONFIG.headline.replace(/\n/g,'<br>');
    $('#year').textContent = new Date().getFullYear();

    function daysFrom(d){
      const s = new Date(d + 'T00:00:00');
      const ms = Date.now() - s.getTime();
      return Math.floor(ms / 86400000);
    }
    $('#dayCount').textContent = daysFrom(CONFIG.startDate);

    // ç”œèœœå€’æ•°
    function tickCountdown(){
      const end = new Date(CONFIG.nextAnniv + 'T00:00:00');
      let diff = Math.max(0, Math.floor((end - Date.now()) / 1000));
      const d = Math.floor(diff / 86400); diff -= d*86400;
      const h = Math.floor(diff / 3600); diff -= h*3600;
      const m = Math.floor(diff / 60); const s = diff - m*60;
      const pad = (n)=>String(n).padStart(2,'0');
      $('#cDay').textContent = pad(d);
      $('#cHour').textContent = pad(h);
      $('#cMin').textContent = pad(m);
      $('#cSec').textContent = pad(s);
    }
    setInterval(tickCountdown, 1000); tickCountdown();

    // ====== æµ®åŠ¨å°å¿ƒå¿ƒ ======
    function spawnHeart(){
      const h = document.createElement('div');
      h.className = 'heart';
      const size = 10 + Math.random()*18; // px
      h.style.width = h.style.height = size + 'px';
      h.style.left = (Math.random()*100) + 'vw';
      h.style.animationDuration = (10 + Math.random()*8) + 's';
      h.style.opacity = (.10 + Math.random()*0.18).toFixed(2);
      hearts.appendChild(h);
      setTimeout(()=> h.remove(), 16000);
    }
    for(let i=0;i<28;i++) setTimeout(spawnHeart, i*220);
    setInterval(spawnHeart, 900);

    // ====== éŸ³ä¹æ§åˆ¶ï¼ˆè‡ªåŠ¨æ’­æ”¾éœ€ç”¨æˆ·äº¤äº’ï¼‰ ======
    let playing = false;
    async function playMusic(){
      try{
        await bgm.play();
        playing = true;
        disk.style.animationPlayState = 'running';
        badge.textContent = 'æ­£åœ¨æ’­æ”¾';
      }catch(err){
        console.log('Autoplay blocked:', err);
      }
    }
    function pauseMusic(){ bgm.pause(); playing=false; disk.style.animationPlayState='paused'; badge.textContent='ç‚¹å‡»æ’­æ”¾'; }

    $('#btnPlay').addEventListener('click', ()=> playing? pauseMusic() : playMusic());
    badge.addEventListener('click', ()=> playing? pauseMusic() : playMusic());
    document.addEventListener('visibilitychange', ()=> { if(document.hidden) pauseMusic(); });

    // ====== Modal ======
    const letterModal = $('#letterModal');
    const storyModal = $('#storyModal');
    $('#btnLetter').onclick = () => letterModal.showModal();
    $('#closeLetter').onclick = () => letterModal.close();
    $('#btnStory').onclick = () => storyModal.showModal();
    $('#closeStory').onclick = () => storyModal.close();

    // ====== æ±‚å©šæŒ‰é’® & çƒŸèŠ± ======
    const fw = document.getElementById('fw');
    const ctx = fw.getContext('2d');
    let W,H; function resize(){ W = fw.width = innerWidth; H = fw.height = innerHeight; }
    addEventListener('resize', resize); resize();

    function rand(n){ return Math.random()*n; }
    class Particle{
      constructor(x,y,angle,speed,color){ Object.assign(this,{x,y, vx:Math.cos(angle)*speed, vy:Math.sin(angle)*speed, life:60+rand(30), color}); }
      step(){ this.vx *= .99; this.vy = this.vy*.99 + 0.15; this.x+=this.vx; this.y+=this.vy; this.life--; }
      draw(){ ctx.globalAlpha = Math.max(this.life/90,0); ctx.beginPath(); ctx.arc(this.x,this.y,2,0,6.28); ctx.fillStyle=this.color; ctx.fill(); }
    }
    const particles = [];
    function boom(x,y){
      const colors = ['#ff5c8a','#ffd166','#ff85a1','#ffffff'];
      for(let i=0;i<180;i++){
        const a = rand(Math.PI*2), s = 1.5+rand(4), c = colors[i%colors.length];
        particles.push(new Particle(x,y,a,s,c));
      }
      // å°æç¤º
      const msg = document.createElement('div');
      msg.textContent = 'è°¢è°¢ä½ è¯´æ„¿æ„ â¤';
      Object.assign(msg.style, { position:'fixed', left:'50%', top:'46%', transform:'translate(-50%,-50%)', padding:'10px 14px', background:'#fff', border:'1px solid #ffd1e2', borderRadius:'999px', color:'#ff2f78', fontWeight:'800', zIndex:4, boxShadow:'0 10px 30px rgba(255,92,138,.25)'});
      document.body.appendChild(msg); setTimeout(()=> msg.remove(), 1600);
    }
    function draw(){
      ctx.clearRect(0,0,W,H);
      for(let i=particles.length-1;i>=0;i--){ const p = particles[i]; p.step(); p.draw(); if(p.life<=0) particles.splice(i,1); }
      requestAnimationFrame(draw);
    } draw();

    function ask(){
      playMusic();
      boom(innerWidth/2, innerHeight/2);
    }
    document.getElementById('btnAsk').addEventListener('click', ask);

    // ====== ä¸€ç‚¹ç‚¹ç»†èŠ‚ ======
    // é¦–æ¬¡äº¤äº’åå°è¯•æ’­æ”¾
    window.addEventListener('click', function initOnce(){ playMusic(); window.removeEventListener('click', initOnce); }, { once:true });
  </script>
</body>
</html>
